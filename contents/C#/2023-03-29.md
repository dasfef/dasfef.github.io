---
layout: default
permalink: /csharp/2
permalink_name: /posts
title:  "[ì•„ë‘ì´ë…¸, C#]Delegate, BeginInvoke ë¡œ ì‹œë¦¬ì–¼ í†µì‹  ì§„í–‰í•˜ê¸°"
---

<p style="text-align:right; font-weight:bold;">2023.03.29</p>

<br>
ì•„ë‘ì´ë…¸ì™€ C# ì˜ ì‹œë¦¬ì–¼ í†µì‹ 

â€‹<br>

<span class="mini-title">1. ì•„ë‘ì´ë…¸ í†µì‹  ì²´í¬</span>

```cpp
int Count = 0;

void setup() {
  Serial.begin(9600);

}

void loop() {
  Serial.println(Count);
  if(Count++ > 9999) Count = 0;
  delay(500);
}
```

<figure class="fig">
<img class="image" src="../contents/imgs/csharp_2/1.png">
</figure>

ì •ìƒ ì—°ê²° ë° ë™ì‘ ì‹œ
0.5ì´ˆë§ˆë‹¤ 1ì”© ì¦ê°€í•˜ë©°
ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„°ì— ì¶œë ¥ëœë‹¤
<br>
â€‹ì•„ë‘ì´ë…¸ì— ì´ìƒ ì—†ìŒ ì²´í¬

â€‹<br>

<span class="mini-title">2. C# ìœˆë„ìš° í¼ ë””ìì¸</span>
<figure class="fig">
<img class="image" src="../contents/imgs/csharp_2/2.png">
</figure>

C# ë‚´ ê°„ë‹¨í•œ ìœˆë„ìš° í¼ ë””ìì¸
ë„êµ¬ : textBox
Dock : Fill

<br>
<span class="mini-title">3. ì½”ë“œ êµ¬ì„±</span>

```cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.IO.Ports;                          // í¬íŠ¸ ì„¤ì •ì„ ìœ„í•œ í˜¸ì¶œ

namespace Serial_to_LCD
{
    public partial class Form1 : Form
    {
        SerialPort ComPort = new SerialPort();  // ì „ì—­ë³€ìˆ˜ ComPort ì„¤ì •
        public Form1()
        {
            InitializeComponent();
        }
    }
}
```

ìœ„ì™€ ê°™ì´ í¼ ë¡œë“œ ì „ì—
êµ¬ì„±ì„ í•´ì£¼ê³ 

â€‹í¼ ë¡œë“œì™€ í´ë¡œì§• ì‹œ
í•„ìš”í•œ ì½”ë“œë¥¼ êµ¬ì„±í•œë‹¤

```cs
â€‹private void Form1_Load(object sender, EventArgs e)
        {
            ComPort.PortName = "COM3";          // ì•„ë‘ì´ë…¸ê°€ ì—°ê²°ëœ í¬íŠ¸ ë²ˆí˜¸
            ComPort.BaudRate = 9600;            // ì¼ë°˜ì ìœ¼ë¡œ 9600
            ComPort.DataBits = 8;               // í†µì‹ ì˜ ë¹„íŠ¸ ì„¤ì • : ì¼ë°˜ì ìœ¼ë¡œ 8ë¹„íŠ¸
            ComPort.Parity = Parity.None;       // í†µì‹ ì˜ ì •í™•ë„ë¥¼ ìœ„í•œ íŒ¨ë¦¬í‹° ê²€ì‚¬(1ì˜ ê°œìˆ˜ì˜ ì§/í™€ ì—¬ë¶€)
            ComPort.StopBits = StopBits.One;    // í†µì‹  ë§ë¯¸ 1ë¡œ ì§€ì •
            ComPort.Handshake = Handshake.None;
            ComPort.Open();
            ComPort.DiscardInBuffer();          // ìˆ˜ì‹  ë²„í¼ ë°ì´í„° ì‚­ì œ
        }

        private void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            ComPort.Close();                    // ì‹œë¦¬ì–¼ í¬íŠ¸ ë‹«ìŒ
            ComPort.Dispose();                  // ì‹œë¦¬ì–¼ í¬íŠ¸ ì™„ì „ í•´ì œ
            ComPort = null;
        }
```

í¼ ë¡œë“œì‹œ êµ¬ì„±ë˜ëŠ” ì½”ë“œ ì¤‘
databits, parity, stopbits, handshake ëŠ”
ì‹œë¦¬ì–¼ í¬íŠ¸ ì„¸íŒ… ì˜µì…˜ì´ë‹¤

ì¼ë°˜ì ìœ¼ë¡œ ìœ„ì™€ ê°™ì€ êµ¬ì„±ì´
ê¸°ë³¸ê°’ìœ¼ë¡œ êµ¬ì„±ë˜ë©°,
ì •í™•í•œ í†µì‹  ì„¸íŒ…ì„ ìœ„í•´ì„ 
íŠ¹ì • ê°’ì„ ì§€ì •í•´ì£¼ì§€ë§Œ
ê°„ë‹¨í•œ êµ¬ì„±ì—ì„ 
ì œì™¸í•´ë„ êµ¬ë™ì´ ê°€ëŠ¥í•˜ë‹¤

â€‹í•˜ì§€ë§Œ ê·¸ëŸ¼ì—ë„ ì—¬ëŸ¬ ì˜µì…˜ì´ ìˆë‹¤ëŠ” ê²ƒì€
ì•Œì•„ë‘ë©´ ë‚˜ì˜ì§€ ì•Šìœ¼ë‹ˆ ì•„ë˜ì— ì •ë¦¬í•´ë‘ì

>>databits : 8, 7, 6
>>parity : none, even, mark, odd, space
>>handshake : none, Xon/Xoff, request to send, request to send Xon/Xoff

<br>
ğŸŒ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ìƒì„±

```cs
public Form1()
        {
            InitializeComponent();
            ComPort.DataReceived += new SerialDataReceivedEventHandler(DataReceived);
        }

        private void DataReceived(object sender, System.IO.Ports.SerialDataReceivedEventArgs e)
        {
            string rxd = ComPort.ReadTo("\n");
        }
```

Comport.ReadTo() ë¡œ \n ê¹Œì§€ ì½ê³ 
ë°ì´í„°ë¥¼ Delegate ë¡œ ì†¡ì‹ í•œë‹¤

â€‹<br>
ğŸŒ delegate êµ¬ì„±

<figure class="fig">
<img class="image" src="../contents/imgs/csharp_2/3.png">
</figure>

ì²˜ìŒ ë³´ë©´ ì´í•´í•˜ê¸° ì–´ë µë‹¤ ğŸ˜°
delegate ëŠ” ëŒ€ë¦¬ì ì—­í• ì´ë‹¤

A ì—ì„œ B ë¡œ ë°ì´í„°ê°€ ì§ì ‘ ì „ë‹¬ì´ ì•„ë‹Œ
delegate ë¼ëŠ” ëŒ€ë¦¬ìë¥¼ í†µí•´
<br>
â€‹A -> delegate -> B
<br>


ì´ëŸ° ì‹ìœ¼ë¡œ ë°ì´í„°ê°€ ì „ë‹¬ëœë‹¤


â€‹â‘  : SetTextDelegate ë¼ëŠ” í•¨ìˆ˜ì—ê²Œ delegate ì„ ì–¸

â‘¡ : BeginInvoke ë¡œ ëŒ€ë¦¬ì ë¹„ë™ê¸°ì‹ ì‹¤í–‰

â‘¢ SetTextDelegate ë¼ëŠ” delegate ì˜ ì¸ìˆ˜ì—

textBox1.AppendText ë¥¼ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜ ì§€ì •

â€‹

ìœ„ ë‹¨ê³„ë¥¼ ê±°ì³ ì§„í–‰ì´ ë˜ê³ ,
ìµœì¢…ì ìœ¼ë¡œ ì‹¤í–‰ì´ ë˜ëŠ” í¼ì˜ ëª¨ì–‘ì„ í™•ì¸í•˜ì
<span class="caution">* ì•„ë‘ì´ë…¸ì˜ ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„°ê°€ êº¼ì ¸ ìˆì–´ì•¼ í•¨
ì¼œì ¸ ìˆìœ¼ë©´ í¬íŠ¸ê°€ ê²¹ì³ ì‹¤í–‰ ì•ˆë¨</span>

<br>
<p style="text-align: center;">[ ì‹¤í–‰ëœ í¼ ]</p>
<figure class="fig">
<img class="image" src="../contents/imgs/csharp_2/4.png">
</figure>

ì´ë ‡ê²Œ ì‹¤í–‰ëœ í¼ì„ í™œìš©í•´
ì»´í“¨í„°ì— êµ¬ì„±ëœ í¬íŠ¸ ì¤‘ ì„ íƒí•  ìˆ˜ ìˆëŠ” ì½¤ë³´ë°•ìŠ¤,
ë¹„íŠ¸ ì „ì†¡ ì†ë„ ë“± ì˜µì…˜ì„ ì„ íƒí•  ìˆ˜ ìˆê²Œ
ë§Œë“¤ ìˆ˜ ìˆë‹¤ ğŸ‘

<figure class="fig">
<img class="image" src="../contents/imgs/csharp_2/5.png">
</figure>

<br>
â€‹
ğŸŒ ì•ì„œ ë§í–ˆë˜ ì§€ì • ì˜µì…˜ ë¹¼ë³´ê¸°

```cs
private void Form1_Load(object sender, EventArgs e)
        {
            ComPort.PortName = "COM3";          // ì•„ë‘ì´ë…¸ê°€ ì—°ê²°ëœ í¬íŠ¸ ë²ˆí˜¸
            ComPort.BaudRate = 9600;            // ì¼ë°˜ì ìœ¼ë¡œ 9600
            ComPort.DataBits = 8;               // í†µì‹ ì˜ ë¹„íŠ¸ ì„¤ì • : ì¼ë°˜ì ìœ¼ë¡œ 8ë¹„íŠ¸
            ComPort.Parity = Parity.None;       // í†µì‹ ì˜ ì •í™•ë„ë¥¼ ìœ„í•œ íŒ¨ë¦¬í‹° ê²€ì‚¬(1ì˜ ê°œìˆ˜ì˜ ì§/í™€ ì—¬ë¶€)
            ComPort.StopBits = StopBits.One;    // í†µì‹  ë§ë¯¸ 1ë¡œ ì§€ì •
            ComPort.Handshake = Handshake.None;
            ComPort.Open();
            ComPort.DiscardInBuffer();          // ìˆ˜ì‹  ë²„í¼ ë°ì´í„° ì‚­ì œ
        }

        private void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            ComPort.Close();                    // ì‹œë¦¬ì–¼ í¬íŠ¸ ë‹«ìŒ
            ComPort.Dispose();                  // ì‹œë¦¬ì–¼ í¬íŠ¸ ì™„ì „ í•´ì œ
            ComPort = null;
        }
```
ë§ˆì§€ë§‰ìœ¼ë¡œ ìš” ë¶€ë¶„ì— ë“¤ì–´ìˆëŠ” ì‹œë¦¬ì–¼ í¬íŠ¸ ì„¸íŒ… ì˜µì…˜ë“¤
{ databits, parity, stopbits, handshake }
ì„ ë¹¼ì„œ ì‹¤í–‰í•´ë³´ì

â€‹<figure class="fig">
<img class="image" src="../contents/imgs/csharp_2/6.png">
<img class="image" src="../contents/imgs/csharp_2/7.png">
</figure>

ì˜ ì‹¤í–‰ëœë‹¤ :D

<br>

(ì „ì²´ ì½”ë“œ êµ¬ì„±)

```cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.IO.Ports;                          // í¬íŠ¸ ì„¤ì •ì„ ìœ„í•œ í˜¸ì¶œ

namespace Serial_to_LCD
{
    public partial class Form1 : Form
    {
        SerialPort ComPort = new SerialPort();  // ì „ì—­ë³€ìˆ˜ ComPort ì„¤ì •
        private delegate void SetTextDelegate(string getString);

        public Form1()
        {
            InitializeComponent();
            ComPort.DataReceived += new SerialDataReceivedEventHandler(DataReceived);
        }

        private void DataReceived(object sender, System.IO.Ports.SerialDataReceivedEventArgs e)
        {
            string rxd = ComPort.ReadTo("\n");
            this.BeginInvoke(new SetTextDelegate(SerialReceived), new object[] { rxd });
        }

        private void SerialReceived(string inString)
        {
            textBox1.AppendText(inString + "\r\n");
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            ComPort.PortName = "COM3";          // ì•„ë‘ì´ë…¸ê°€ ì—°ê²°ëœ í¬íŠ¸ ë²ˆí˜¸
            ComPort.BaudRate = 9600;            // ì¼ë°˜ì ìœ¼ë¡œ 9600
            //ComPort.DataBits = 8;               // í†µì‹ ì˜ ë¹„íŠ¸ ì„¤ì • : ì¼ë°˜ì ìœ¼ë¡œ 8ë¹„íŠ¸
            //ComPort.Parity = Parity.None;       // í†µì‹ ì˜ ì •í™•ë„ë¥¼ ìœ„í•œ íŒ¨ë¦¬í‹° ê²€ì‚¬(1ì˜ ê°œìˆ˜ì˜ ì§/í™€ ì—¬ë¶€)
            //ComPort.StopBits = StopBits.One;    // í†µì‹  ë§ë¯¸ 1ë¡œ ì§€ì •
            //ComPort.Handshake = Handshake.None;
            ComPort.Open();
            ComPort.DiscardInBuffer();          // ìˆ˜ì‹  ë²„í¼ ë°ì´í„° ì‚­ì œ
        }

        private void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            ComPort.Close();                    // ì‹œë¦¬ì–¼ í¬íŠ¸ ë‹«ìŒ
            ComPort.Dispose();                  // ì‹œë¦¬ì–¼ í¬íŠ¸ ì™„ì „ í•´ì œ
            ComPort = null;
        }

        
    }
}
```



íšŒê³ )
delegate ì˜ ì¡´ì¬ì— ëŒ€í•´ ì´í•´ëŠ” ì‰¬ì› ì§€ë§Œ
ì½”ë“œ êµ¬ì„±ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ì´í•´ê°€ ì¡°ê¸ˆ ë¶€ì¡±í–ˆë‹¤

í¬íŠ¸ë¡œ ì „ì†¡ë˜ëŠ” ë°ì´í„°ë¥¼ ë°›ëŠ” ë°©ë²•ì— ìˆì–´
ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì™¸ì—ë„ ì—¬ëŸ¬ ë°©ë²•ì´ ìˆì—ˆëŠ”ë°
ì´ ë¶€ë¶„ì— ëŒ€í•´ ì•Œì•„ë³´ëŠ”ë° ì‹œê°„ì´ ë” í•„ìš”í•  ê²ƒ ê°™ë‹¤

databits, parity, stopbits, handshake ë“±
ìµœê·¼ì—” ì˜µì…˜ ì§€ì • ìì²´ê°€ ì˜ ì“°ì´ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒ ê°™ì€ë°
ì´ ë¶€ë¶„ì€ ì¸í„°ë„·ì— ìˆëŠ” ì •ë³´ ì™¸ì—ë„
ì‹¤ë¬´ì—ì„œ ì§ì ‘ ê²ªì–´ë³´ë©´ì„œ ì•Œì•„ë³´ë©´ ì¢‹ì„ê²ƒ ê°™ë‹¤(ì˜µì…˜ì€ ì•Œì•„ë‘ì)